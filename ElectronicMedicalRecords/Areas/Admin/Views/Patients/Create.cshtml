@model ElectronicMedicalRecords.Models.MultiplesModel
@{
    ViewBag.Title = "Create";
}
<style>
    .choices {
        width: 100%
    }

        .choices[data-type*=select-one]:after {
            margin-top: -5px;
        }

    .choices__input--cloned {
        min-width: 100% !important;
    }

    .choices__inner {
        border: unset;
        padding: 0;
        width: 100%;
    }

    hr {
        color: #435ebe
    }

    .bootstrap-tagsinput {
        width: 100%;
        padding: 0.375rem 0.75rem;
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        color: #607080;
        background-color: #fff;
        background-clip: padding-box;
        border: 1px solid #dce7f1;
        -webkit-appearance: none;
        -moz-appearance: none;
        border-radius: 0.25rem;
        transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
        box-shadow: unset
    }

    .bootstrap-tagsinput .label-info {
        background-color: #435ebe;
        border-radius: 4px;
        padding: 4px
    }

    tr {
        /*display:flex;*/
        justify-content: space-around;
    }

    .table-bordered th {
        border-width: 0px
    }

    .table-bordered tr:first-child {
        background-color: #435ebe;
        color: #fff;
        padding: 5px 0;
        text-align: center
    }

    .table-bordered tr:nth-child(2) td {
        border-width: 1px;
    }

    .table-bordered td {
        border-width: 1px
    }

    .pd-0px {
        padding: 0 1rem;
    }
</style>
<header class="mb-3">
    <a href="#" class="burger-btn d-block d-xl-none">
        <i class="bi bi-justify fs-3"></i>
    </a>
</header>
@using (Html.BeginForm("Create", "Patients", FormMethod.Post))
{
    @Html.AntiForgeryToken()
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <a class="nav-link active" id="home-tab" data-bs-toggle="tab" href="#home"
                           role="tab" aria-controls="home" aria-selected="true">Hồ Sơ</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="profile-tab" data-bs-toggle="tab" href="#profile"
                           role="tab" aria-controls="profile" aria-selected="false">Công Thức Máu</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="contact-tab" data-bs-toggle="tab" href="#contact"
                           role="tab" aria-controls="contact" aria-selected="false">Lâm Sàng</a>
                    </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="home" role="tabpanel"
                         aria-labelledby="home-tab">
                        <p class='my-2'>
                            <section id="multiple-column-form">
                                <div class="row match-height">
                                    <div class="col-12">
                                        <div class="card">
                                            <div class="card-header" style="padding-bottom:0px">
                                                <h4 class="card-title">Thông Tin Hành Chính</h4>
                                                <hr />
                                            </div>
                                            <div class="card-content">
                                                <div class="card-body">
                                                    @*@using (Html.BeginForm("Create", "Patients", FormMethod.Post))
                                                    {
                                                        @Html.AntiForgeryToken()*@
                                                        <div class="row">
                                                            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                                            <div class="col-md-3 col-12">
                                                                <div class="form-group">
                                                                    <label for="first-name-column">Họ Và Tên</label>
                                                                    @Html.EditorFor(model => model.Patient.Name, new { htmlAttributes = new { @class = "form-control", @placeholder = "Họ Và Tên" } })
                                                                    @Html.ValidationMessageFor(model => model.Patient.Name, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-12">
                                                                <div class="form-group">
                                                                    <label for="last-name-column">Giới Tính</label>
                                                                    <div class="position-relative ml-5px">
                                                                        @Html.DropDownList("Patient.Gender_ID", null, htmlAttributes: new { @class = "form-select" })
                                                                        @Html.ValidationMessageFor(model => model.Patient.Gender_ID, "", new { @class = "text-danger" })
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-12">
                                                                <div class="form-group">
                                                                    <label for="city-column">Ngày Sinh</label>
                                                                    <input class="form-control" type="date" name="Patient.BirthDate" id="birthdate" required />
                                                                    @Html.ValidationMessageFor(model => model.Patient.BirthDate, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-12">
                                                                <div class="form-group">
                                                                    <label for="country-floating">Dân Tộc</label>
                                                                    @Html.DropDownList("Patient.Nation1_ID", null, htmlAttributes: new { @class = "form-select" })
                                                                    @Html.ValidationMessageFor(model => model.Patient.Nation1_ID, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-12 col-12">
                                                                <div class="form-group">
                                                                    <label for="company-column">Địa Chỉ</label>
                                                                    @Html.EditorFor(model => model.Patient.Address, new { htmlAttributes = new { @class = "form-control", @placeholder = "Địa Chỉ" } })
                                                                    @Html.ValidationMessageFor(model => model.Patient.Address, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Quê Quán</label>
                                                                    @Html.DropDownList("Patient.HomeTown_ID", null, htmlAttributes: new { @class = "form-select", @name = "Long" })
                                                                    @*<select name="Patient.HomeTown_ID">
                                                                            @for(int i = 0; i < ViewBag.HomeTown_ID.length; i++)
                                                                            {
                                                                                <option value="@i">aa</option>
                                                                            }
                                                                        </select>*@
                                                                    @Html.ValidationMessageFor(model => model.Patient.HomeTown_ID, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Quốc Gia</label>
                                                                    @Html.DropDownList("Patient.Nation_ID", null, htmlAttributes: new { @class = "form-select" })
                                                                    @Html.ValidationMessageFor(model => model.Patient.Nation_ID, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Điện Thoại</label>
                                                                    @Html.EditorFor(model => model.Patient.Phone, new { htmlAttributes = new { @class = "form-control" } })
                                                                    @Html.ValidationMessageFor(model => model.Patient.Phone, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Số BHYT</label>
                                                                    @Html.EditorFor(model => model.Patient.InsuranceCode, new { htmlAttributes = new { @class = "form-control" } })
                                                                    @Html.ValidationMessageFor(model => model.Patient.InsuranceCode, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="card-header" style="padding-bottom:0px">
                                                                <h4 class="card-title">Thông Tin Bệnh Án</h4>
                                                                <hr />
                                                            </div>
                                                            <div class="col-md-12 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Tiền Sử</label>
                                                                    <input type="text" data-role="tagsinput" name="Patient.MedicalHistory" class="form-control">
                                                                    @*@Html.TextBoxFor(model => model.Patient.MedicalHistory, new { htmlAttributes = new { @class = "form-control" } })*@
                                                                    @Html.ValidationMessageFor(model => model.Patient.MedicalHistory, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-12 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Bệnh Sử</label>
                                                                    <input type="text" data-role="tagsinput" name="Patient.HistoryDisease" class="form-control">
                                                                    @*@Html.EditorFor(model => model.Patient.HistoryDisease, new { htmlAttributes = new { @class = "form-control" } })*@
                                                                    @Html.ValidationMessageFor(model => model.Patient.HistoryDisease, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="card-header" style="padding-bottom:0px">
                                                                <h4 class="card-title">Thông Tin Khám bệnh</h4>
                                                                <hr />
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Ngày Đến</label>
                                                                    <input name="InformationExamination.DateExamine" type="datetime" value="@ViewBag.DateExamination" class="form-control" readonly />
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.DateExamine, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Ngày Đi</label>
                                                                    <input name="InformationExamination.DateEnd" type="date" class="form-control" />
                                                                    @*@Html.EditorFor(model => model.InformationExamination.DateEnd, new { htmlAttributes = new { @class = "form-control" } })*@
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.DateEnd, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Bác Sĩ</label>
                                                                    @Html.HiddenFor(model => model.InformationExamination.User_ID, new { htmlAttributes = new { @class = "form-control", @Value = ViewBag.UserByID } })
                                                                    <input value="@ViewBag.UserName" class="form-control" readonly />
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.User_ID, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Nhịp Tim</label>
                                                                    @Html.EditorFor(model => model.InformationExamination.HeartBeat, new { htmlAttributes = new { @class = "form-control" } })
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.HeartBeat, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Nhịp Thở</label>
                                                                    @Html.EditorFor(model => model.InformationExamination.Breathing, new { htmlAttributes = new { @class = "form-control" } })
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.Breathing, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Huyết Áp</label>
                                                                    @Html.EditorFor(model => model.InformationExamination.BloodPressure, new { htmlAttributes = new { @class = "form-control" } })
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.BloodPressure, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Cân Nặng</label>
                                                                    @Html.EditorFor(model => model.InformationExamination.Weight, new { htmlAttributes = new { @class = "form-control" } })
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.Weight, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Chiều Cao</label>
                                                                    @Html.EditorFor(model => model.InformationExamination.Height, new { htmlAttributes = new { @class = "form-control" } })
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.Height, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Tình Trạng</label>
                                                                    @Html.DropDownList("InformationExamination.PatientStatus_ID", null, htmlAttributes: new { @class = "form-select" })
                                                                    @Html.ValidationMessageFor(model => model.InformationExamination.PatientStatus_ID, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            @*<div class="card-header" style="padding-bottom:0px">
                                                                    <h4 class="card-title">Thông Tin Xét Nghiệm</h4>
                                                                    <hr />
                                                                </div>
                                                                <div class="col-md-12">
                                                                    <button type="button" class="btn btn-primary" onclick="insRow()">Tạo</button>
                                                                    <table id="TableTest" style="width:100%" border="1" class="table-bordered">
                                                                        <tr>
                                                                            <th>Yêu cầu xét nghiệm</th>
                                                                            <th>Kết quả xét nghiệm</th>
                                                                            <th>Chức năng</th>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <input type="text" id="latbox" name="MedicalTestsPrescription[0].Name" class='form-control' />
                                                                            </td>
                                                                            <td>
                                                                                <input type="text" id="lngbox" name="MedicalTestsPrescription[0].Result" class='form-control' />
                                                                            </td>
                                                                            <td><input class="btn btn-primary" type="button" id="delPOIbutton" value="Delete" onclick="deleteRow(this)" /></td>
                                                                        </tr>
                                                                    </table>
                                                                </div>*@
                                                            <div class="card-header" style="padding-bottom:0px">
                                                                <h4 class="card-title">Thông Tin Toa Thuốc</h4>
                                                                <hr />
                                                            </div>
                                                            <div class="col-md-8 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Tên Thuốc</label>
                                                                    <select id="NameMedication" name="Medication.Name" class="choices form-select">
                                                                        <option placeholder>Vui Lòng Chọn Tên Thuốc</option>
                                                                        @foreach (var medication in ViewBag.NameMedication)
                                                                        {
                                                                            <option value="@medication.ID">@medication.Name</option>
                                                                        }
                                                                    </select>
                                                                    @*@Html.TextBoxFor(model => model.Medication.Name, new { htmlAttributes = new { @class = "form-control" } })*@
                                                                    @Html.ValidationMessageFor(model => model.Medication.Name, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Liều lượng</label>
                                                                    <div class="input-group mb-3">
                                                                        <input type="number" id="UnitMedication" name="Prescription_Detail.NumMedication" class="form-control">
                                                                        <span class="input-group-text" id="DVT"></span>
                                                                    </div>
                                                                    @*@Html.TextBoxFor(model => model.Prescription_Detail.NumMedication, new { htmlAttributes = new { @class = "form-control" } })*@
                                                                    @Html.ValidationMessageFor(model => model.Prescription_Detail.NumMedication, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-8 col-12">
                                                                <div class="form-group">
                                                                    <label for="email-id-column">Ghi Chú</label>
                                                                    <input id="NoteMedication" type="text" name="Prescription_Detail.Note" class="form-control">
                                                                    @*@Html.TextBoxFor(model => model.Patient.MedicalHistory, new { htmlAttributes = new { @class = "form-control" } })*@
                                                                    @Html.ValidationMessageFor(model => model.Prescription_Detail.Note, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4" style="position: relative;top:23px">
                                                                <button type="button" class="btn btn-primary" onclick="insRowMedication()">Thêm Thuốc</button>
                                                            </div>
                                                            <div class="col-md-12">
                                                                <table id="TableMedication" style="width:100%" border="1" class="table-bordered">
                                                                    <tr>
                                                                        <th>Tên Thuốc</th>
                                                                        <th>Liều Lượng</th>
                                                                        <th>Ghi Chú</th>
                                                                        <th>Gỡ Bỏ</th>
                                                                    </tr>
                                                                </table>
                                                            </div>

                                                            <div class="col-12 d-flex justify-content-end pt-4">
                                                                <button type="submit"
                                                                        class="btn btn-primary me-1 mb-1">
                                                                    Tạo Hồ Sơ
                                                                </button>
                                                                <button type="reset"
                                                                        class="btn btn-light-secondary me-1 mb-1">
                                                                    Reset
                                                                </button>
                                                            </div>
                                                        </div>
                                                    @*}*@
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </p>
                    </div>
                    <div class="tab-pane fade" id="profile" role="tabpanel"
                         aria-labelledby="profile-tab">
                        <div class="page-heading">
                            <section class="section">
                                <div class="card">
                                    <div class="card-header pd-0px">
                                        <h6 style="margin: 1rem 0.5rem">
                                            Số lượng xét nghiệm :
                                            <span id="countTests">0</span>
                                            <!-- button trigger for  Vertically Centered modal -->
                                            <button style="display:none" onclick="loadDetailTests()" id="DetailTestCount" type="button" class="btn btn-outline-primary block"
                                                    data-bs-toggle="modal" data-bs-target="#exampleModalCenter">
                                                Chi Tiết
                                            </button>
                                            <!-- Vertically Centered modal Modal -->
                                            <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
                                                 aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                                                <div style="max-width:900px" class="modal-dialog modal-dialog-centered modal-dialog-centered modal-dialog-scrollable"
                                                     role="document">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="exampleModalCenterTitle">
                                                                Chỉ định xét nghiệm
                                                            </h5>
                                                            <button type="button" class="close" data-bs-dismiss="modal"
                                                                    aria-label="Close">
                                                                <i data-feather="x"></i>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <table class="table table-striped" id="tableNewBloods" style="width: 100%">
                                                                <thead>
                                                                    <tr>
                                                                        <th>Chỉ Định</th>
                                                                        <th>Tên Xét Nghiệm</th>
                                                                        <th>Kết Quả</th>
                                                                        <th>Chỉ Số Cân Bằng</th>
                                                                        <th>Đơn Vị</th>
                                                                        <th>Máy XN</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button onclick="destroytable()" type="button" class="btn btn-primary ml-1"
                                                                    data-bs-dismiss="modal">
                                                                <i class="bx bx-check d-block d-sm-none"></i>
                                                                <span class="d-none d-sm-block">Tắt</span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </h6>
                                    </div>
                                    <div class="card-body">
                                        <table class="table table-striped" id="tableCTMaus" style="width:100%">
                                            <thead>
                                                <tr>
                                                    <th hidden></th>
                                                    <th>Chỉ Định</th>
                                                    <th>Tên Xét Nghiệm</th>
                                                    <th>Kết Quả</th>
                                                    <th>Chỉ Số Cân Bằng</th>
                                                    <th>Đơn Vị</th>
                                                    <th>Máy XN</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @for(int i = 0; i < ViewBag.CTMau.Count; i++)
                                                {
                                                    <tr>
                                                        <td hidden>
                                                            <input value="@ViewBag.CTMau[i].ID" type="text" name="CTMau[@i].ID" hidden />
                                                        </td>
                                                        <td>
                                                            <input type="checkbox" value="false" class="form-check-input form-check-primary" name="CTMau[@i].ChiDinh" id="customColorCheck-@ViewBag.CTMau[i].ID" onchange="updateCountTests(@ViewBag.CTMau[i].ID, event)">
                                                        </td>
                                                        <td>
                                                            <input value="@ViewBag.CTMau[i].NameTest" type="text" name="CTMau[@i].NameTest" hidden />
                                                            <label class="form-check-label" for="customColorCheck-@ViewBag.CTMau[i].ID">@ViewBag.CTMau[i].NameTest</label>
                                                        </td>
                                                        <td>
                                                            <input value="@ViewBag.CTMau[i].Result" type="text" name="CTMau[@i].Result" hidden />
                                                            @ViewBag.CTMau[i].Result
                                                        </td>
                                                        <td>
                                                            <input value="@ViewBag.CTMau[i].CSBT" type="text" name="CTMau[@i].CSBT" hidden />
                                                            @ViewBag.CTMau[i].CSBT
                                                        </td>
                                                        <td>
                                                            <input value="@ViewBag.CTMau[i].Unit" type="text" name="CTMau[@i].Unit" hidden />
                                                            @ViewBag.CTMau[i].Unit
                                                        </td>
                                                        <td>
                                                            <input value="@ViewBag.CTMau[i].MayXN" type="text" name="CTMau[@i].MayXN" hidden />
                                                            @ViewBag.CTMau[i].MayXN
                                                        </td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="contact" role="tabpanel"
                         aria-labelledby="contact-tab">
                        <p class="mt-2">
                            Duis ultrices purus non eros fermentum hendrerit. Aenean
                            ornare interdum
                            viverra. Sed ut odio velit. Aenean eu diam
                            dictum nibh rhoncus mattis quis ac risus. Vivamus eu congue ipsum.
                            Maecenas id
                            sollicitudin ex. Cras in ex vestibulum,
                            posuere orci at, sollicitudin purus. Morbi mollis elementum enim, in
                            cursus sem
                            placerat ut.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
}


@section scripts{
    <script>
        var k = 1;
        var count = 0;
        var arrTests = [];
        /*Load Detail Test*/
        function loadDetailTests() {
            $('#tableNewBloods').DataTable({
                    "ajax": {
                        "url": "@Url.Action("LoadDetailBloods", "Patients")",
                        "type": "POST",
                        "data": function (d) {
                            d.arr = arrTests
                        }
                    },
                    "columns": [
                        {
                            "data": "ChiDinh",
                            "name": "Chỉ Định",
                            "render": (data, type, row) => {
                                var checkbox = "<input type='checkbox' checked class='form-check-input form-check-primary' name='CTMau.ChiDinh' id='customColorCheckNew-" + row.ID + "' onchange='updateNewCountTests(" + row.ID + ")'>"
                                return checkbox;
                            },
                        },
                        {
                            "data": "NameTest",
                            "name": "Tên Xét Nghiệm",
                            "render": (data, type, row) => {
                                var label = "<label class='form-check-label' for='customColorCheckNew-" + row.ID + "'>" + row.NameTest + "</label>"
                                return label;
                            }
                        },
                        {
                            "data": "Result",
                            "name": "Kết Quả"
                        },
                        {
                            "data": "CSBT",
                            "name": "Chỉ Số Bình Thường"
                        },
                        {
                            "data": "Unit",
                            "name": "Đơn Vị"
                        },
                        {
                            "data": "MayXN",
                            "name": "Máy Xét Nghiệm"
                        }
                    ],
                    "language": {
                        "emptyTable": "No data available",
                        "oPaginate": {
                            sNext: '<i class="fa fa-chevron-right"></i>',
                            sPrevious: '<i class="fa fa-chevron-left"></i>',
                        },
                        "info": "Hiển thị _START_/_END_ trên tổng _TOTAL_",
                        "lengthMenu": "Hiển thị _MENU_ danh mục thuốc",
                        "search": "Tìm kiếm:",
                    },
                })
            }

            function destroytable() {
                var table = $('#tableNewBloods').DataTable();
                table.destroy();
            }
            function updateCountTests(id, e) {
                if (e.target.checked == true) {
                    $('#customColorCheck-' + id).attr("value",true);
                    count++;
                    arrTests.push(id);
                } else {
                    count--;
                    $('#customColorCheck-' + id).attr("value",false);
                    const index = arrTests.indexOf(id);
                    arrTests.splice(index, 1);
                }
                if (count > 0) {
                    $('#DetailTestCount').css("display", "block")
                } else {
                    $('#DetailTestCount').css("display", "none")
                }
                document.querySelector('#countTests').innerHTML = count;
            }

            function updateNewCountTests(id) {
                var exist = arrTests.indexOf(id);
                arrTests.splice(exist, 1);
                count--;
                document.querySelector('#countTests').innerHTML = count;
                $('#customColorCheck-' + id).attr("value", false);
                $('#customColorCheck-' + id).attr("checked", false);
                $('#tableNewBloods').DataTable().ajax.reload();
            }

            var formatCss = document.querySelector('.choices__list--single');
            formatCss.classList.add('form-control');

            var select = document.querySelector('#NameMedication');
            select.addEventListener('change', (e) => {
                var id = parseInt(e.target.value);
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("FindMedication", "Medications")",
                    data: { id: id},
                    success: (res) => {
                        document.querySelector('#DVT').innerHTML = res.data
                    }
                })
            })

            function insRowMedication() {
                var NameMedication = $('#NameMedication').text();
                var UnitMedication = $('#UnitMedication').val();
                var NoteMedication = $('#NoteMedication').val();
                var medication = document.getElementById('TableMedication');
                var row = medication.insertRow(k);
                var cell0 = row.insertCell(0);
                var cell1 = row.insertCell(1);
                var cell2 = row.insertCell(2);
                var cell3 = row.insertCell(3);
                cell0.innerHTML = NameMedication;
                cell1.innerHTML = UnitMedication;
                cell2.innerHTML = NoteMedication;
                cell3.innerHTML = "<button class='btn btn-primary' id='Medication-"+ k +"' type='button' onClick='deleteRow(" + k + ")'>Delete</button>";
                k++;
            }

            function deleteRow(btn) {
                var index = $("#Medication-" + btn);
                index.parent().parent().remove();
                k--;
            }

            $('#tableCTMaus').DataTable({
                "pageLength": 25,
                "language": {
                    "emptyTable": "No data available",
                    "oPaginate": {
                        sNext: '<i class="fa fa-chevron-right"></i>',
                        sPrevious: '<i class="fa fa-chevron-left"></i>',
                    },
                    "info": "Hiển thị _START_/_END_ trên tổng _TOTAL_",
                    "lengthMenu": "Hiển thị _MENU_ danh mục thuốc",
                    "search": "Tìm kiếm:",
                },
            });
    </script>
}